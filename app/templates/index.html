{% extends "base.html" %}

{% block content %}
<div class="container">
  <h1>Список мероприятий</h1>
  {% for event in events %}
    <div class="card mb-3">
      <div class="card-body">
        <h4>{{ event.name }}</h4>
        <p>{{ event.date }} | {{ event.place }} | Организатор: {{ event.organizer.last_name }}</p>
        <p>Регистраций: {{ event.registrations|selectattr("status","equalto","accepted")|list|length }} / {{ event.volunteers_required }}</p>
        {% if (event.registrations|selectattr("status","equalto","accepted")|list|length) >= event.volunteers_required %}
          <span class="badge bg-danger">Регистрация закрыта</span>
        {% else %}
          <span class="badge bg-success">Идёт набор волонтеров</span>
        {% endif %}
        <a href="{{ url_for('main.event_detail', id=event.id) }}">Подробнее</a>
      </div>
    </div>
  {% else %}
    <p>Нет предстоящих мероприятий.</p>
  {% endfor %}

  <!-- Пагинация -->
  <nav>
    <ul class="pagination">
      {% if pagination.has_prev %}
        <li class="page-item">
          <a class="page-link" href="{{ url_for('main.index', page=pagination.prev_num) }}">← Назад</a>
        </li>
      {% endif %}
      <li class="page-item disabled">
        <span class="page-link">Стр. {{ pagination.page }} из {{ pagination.pages }}</span>
      </li>
      {% if pagination.has_next %}
        <li class="page-item">
          <a class="page-link" href="{{ url_for('main.index', page=pagination.next_num) }}">Вперёд →</a>
        </li>
      {% endif %}
    </ul>
  </nav>
</div>
{% endblock %}
